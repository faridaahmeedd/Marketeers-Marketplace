@using MarketeersMarketplace.ViewModels
@model List<TalentCardVM>
@using Microsoft.AspNetCore.Mvc.Rendering

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Material Design for Bootstrap</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css" />
    <!-- Google Fonts Roboto -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" />
    <!-- MDB -->
    <link rel="stylesheet" href="./css/mdb.min.css" />
</head>
<body>
 <!--Main layout-->
 <main class="my-5" >
    <div class="container">
      <!--Section: Content-->
      <section class="text-center">
        <h4 class="mb-5"><strong>Featured Talents</strong></h4>
                <div class="d-flex justify-content-center mb-4">
                    <form method="get" asp-action="DisplayTalents" asp-controller="Talent" class="w-auto" id="categoryFilterForm">
                        <div class="d-flex align-items-center">
                            <input type="text" name="searchTerm" class="form-control mx-5 me-2" placeholder="Search talents..." aria-label="Search" style="width: 200px;">
                            <select id="categoryFilter" name="selectedCategory" class="form-select mx-5" asp-items="ViewBag.Categories" style="width: 250px;" onchange="this.form.submit();">
                                <option value="">--Select Category--</option>
                            </select>
                        </div>
                    </form>
                </div>

        <!-- Talents Section -->
        <div id="talentResults" class="row">
            @for (int i = 0; i < Model.Count && i < 6; i++) {
                <div class="col-lg-4 mb-5">
                        <a href="/Talent/DisplayProfile?id=@Model.ToArray()[i].Id" class="card h-100 shadow border-0 text-decoration-none text-dark">
                                <img class="card-img-top fixed-image" src="~/images/@Model.ToArray()[i].ImagePath" alt="..." />
                                <div class="card-body p-4">
                                <div class="badge bg-primary bg-gradient rounded-pill mb-2">@Model.ToArray()[i].CategoryName</div>
                                <h5 class="card-title mb-3">@Model.ToArray()[i].Name</h5>
                                <p class="card-text mb-0">@Model.ToArray()[i].Bio</p>
                            </div>
                        </a>
                </div>
            }
        </div>
        <!-- End Talents Section -->
        
      </section>
            <nav class="my-4" aria-label="...">
                <ul class="pagination pagination-circle justify-content-center">
                    @if (ViewBag.CurrentPage > 1)
                    {
                        <li class="page-item">
                            <a class="page-link" href="@Url.Action("DisplayTalents", "Talent", new { page = ViewBag.CurrentPage - 1 })" tabindex="-1">Previous</a>
                        </li>
                    }
                    else
                    {
                        <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                        </li>
                    }

                    @for (int i = 1; i <= ViewBag.TotalPages; i++)
                    {
                        if (i == ViewBag.CurrentPage)
                        {
                            <li class="page-item active" aria-current="page">
                                <a class="page-link" href="#">@i <span class="sr-only">(current)</span></a>
                            </li>
                        }
                        else
                        {
                            <li class="page-item">
                                <a class="page-link" href="@Url.Action("DisplayTalents", "Talent", new { page = i })">@i</a>
                            </li>
                        }
                    }

                    @if (ViewBag.CurrentPage < ViewBag.TotalPages)
                    {
                        <li class="page-item">
                            <a class="page-link" href="@Url.Action("DisplayTalents", "Talent", new { page = ViewBag.CurrentPage + 1 })">Next</a>
                        </li>
                    }
                    else
                    {
                        <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Next</a>
                        </li>
                    }
                </ul>
            </nav>

    </div>
  </main>
    <!-- Bootstrap core JS-->
    <script type="text/javascript" src="./js/mdb.umd.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            // Event listener for the search input
            $('input[name="searchTerm"]').on('input', function () {
                const searchTerm = $(this).val();
                const selectedCategory = $('#categoryFilter').val();
                $.ajax({
                    url: '@Url.Action("DisplayTalents", "Talent")', // Your action method here
                    type: 'GET',
                    data: { searchTerm: searchTerm, selectedCategory: selectedCategory },
                    success: function (data) {
                        $('#talentResults').html(data); // Update the results container
                    }
                });
            });

            // Event listener for category change
            $('#categoryFilter').on('change', function () {
                const searchTerm = $('input[name="searchTerm"]').val();
                const selectedCategory = $(this).val();
                $.ajax({
                    url: '@Url.Action("DisplayTalents", "Talent")',
                    type: 'GET',
                    data: { searchTerm: searchTerm, selectedCategory: selectedCategory },
                    success: function (data) {
                        $('#talentResults').html(data); // Update the results container
                    }
                });
            });
        });
    </script>

</body> 
</html>
